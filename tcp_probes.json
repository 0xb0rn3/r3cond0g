[
  {
    "name": "SSH-Banner-Grab",
    "protocol": "TCP",
    "ports": [22, 2222],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^SSH-([0-9.]+)-([^\\s\\r\\n]+)(?:\\s+(.*))?",
    "service_override": "ssh",
    "version_template": "{{group_2}} (protocol {{group_1}})",
    "timeout_ms": 3000
  },
  {
    "name": "HTTP-Server-Header",
    "protocol": "TCP",
    "ports": [80, 8080, 8000, 3000],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "HEAD / HTTP/1.1\\r\\nHost: {{TARGET_HOST}}\\r\\nUser-Agent: r3cond0g/0.2.3\\r\\nConnection: close\\r\\n\\r\\n",
    "read_pattern": "(?i)Server:\\s*([^\\r\\n]+)",
    "service_override": "http",
    "version_template": "{{group_1}}",
    "timeout_ms": 5000
  },
  {
    "name": "HTTPS-Server-Header",
    "protocol": "TCP",
    "ports": [443, 8443, 9443],
    "priority": 15,
    "requires_tls": true,
    "tls_alpn_protocols": ["http/1.1", "h2"],
    "send_payload": "HEAD / HTTP/1.1\\r\\nHost: {{TARGET_HOST}}\\r\\nUser-Agent: r3cond0g/0.2.3\\r\\nConnection: close\\r\\n\\r\\n",
    "read_pattern": "(?i)Server:\\s*([^\\r\\n]+)",
    "service_override": "https",
    "version_template": "{{group_1}}",
    "timeout_ms": 8000
  },
  {
    "name": "FTP-Banner-Grab",
    "protocol": "TCP",
    "ports": [21],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^220[\\s-].*?([^\\s\\r\\n]+)\\s+([0-9.]+)",
    "service_override": "ftp",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 3000
  },
  {
    "name": "SMTP-Banner-Grab",
    "protocol": "TCP",
    "ports": [25, 587],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^220[\\s-].*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "smtp",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 3000
  },
  {
    "name": "SMTPS-Banner-Grab",
    "protocol": "TCP",
    "ports": [465],
    "priority": 10,
    "requires_tls": true,
    "send_payload": "",
    "read_pattern": "^220[\\s-].*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "smtps",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 4000
  },
  {
    "name": "SMTP-EHLO-Probe",
    "protocol": "TCP",
    "ports": [25, 587],
    "priority": 20,
    "requires_tls": false,
    "send_payload": "EHLO {{TARGET_HOST}}\\r\\n",
    "read_pattern": "250[\\s-]([^\\r\\n]+)",
    "service_override": "smtp",
    "version_template": "EHLO Resp: {{group_1}}",
    "timeout_ms": 4000
  },
  {
    "name": "POP3-Banner-Grab",
    "protocol": "TCP",
    "ports": [110],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^\\+OK.*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "pop3",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 3000
  },
  {
    "name": "POP3S-Banner-Grab",
    "protocol": "TCP",
    "ports": [995],
    "priority": 10,
    "requires_tls": true,
    "send_payload": "",
    "read_pattern": "^\\+OK.*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "pop3s",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 4000
  },
  {
    "name": "IMAP-Banner-Grab",
    "protocol": "TCP",
    "ports": [143],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^\\* OK.*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "imap",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 3000
  },
  {
    "name": "IMAPS-Banner-Grab",
    "protocol": "TCP",
    "ports": [993],
    "priority": 10,
    "requires_tls": true,
    "send_payload": "",
    "read_pattern": "^\\* OK.*?([^\\s\\r\\n]+)\\s+([^\\s\\r\\n]+)",
    "service_override": "imaps",
    "version_template": "{{group_1}} {{group_2}}",
    "timeout_ms": 4000
  },
  {
    "name": "Telnet-Banner-Grab",
    "protocol": "TCP",
    "ports": [23],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "([^\\r\\n]+)",
    "service_override": "telnet",
    "version_template": "{{group_1}}",
    "timeout_ms": 2000
  },
  {
    "name": "MySQL-Version-Probe",
    "protocol": "TCP",
    "ports": [3306],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "\\x0a([0-9.]+[^\\x00]*)\\x00",
    "service_override": "mysql",
    "version_template": "{{group_1}}",
    "timeout_ms": 3000
  },
  {
    "name": "PostgreSQL-Startup",
    "protocol": "TCP",
    "ports": [5432],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "\\x00\\x00\\x00\\x08\\x04\\xd2\\x16\\x2f",
    "read_pattern": "FATAL.*?server version \"([^\"]+)\"",
    "service_override": "postgresql",
    "version_template": "{{group_1}}",
    "timeout_ms": 4000
  },
  {
    "name": "Redis-Info-Probe",
    "protocol": "TCP",
    "ports": [6379],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "INFO server\\r\\n",
    "read_pattern": "redis_version:([^\\r\\n]+)",
    "service_override": "redis",
    "version_template": "{{group_1}}",
    "timeout_ms": 3000
  },
  {
    "name": "MongoDB-Hello-Probe",
    "protocol": "TCP",
    "ports": [27017, 27018, 27019],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "\\x3f\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xd4\\x07\\x00\\x00\\x00\\x00\\x00\\x00test.$cmd\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x16\\x00\\x00\\x00\\x01hello\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xf0\\x3f\\x00",
    "read_pattern": "\"version\"\\s*:\\s*\"([0-9.]+)\"",
    "service_override": "mongodb",
    "version_template": "{{group_1}}",
    "timeout_ms": 4000
  },
  {
    "name": "VNC-Version-Probe",
    "protocol": "TCP",
    "ports": [5900, 5901, 5902, 5903],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^RFB ([0-9]+\\.[0-9]+)",
    "service_override": "vnc",
    "version_template": "RFB {{group_1}}",
    "timeout_ms": 3000
  },
  {
    "name": "LDAP-Root-DSE",
    "protocol": "TCP",
    "ports": [389],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "\\x30\\x1d\\x02\\x01\\x01\\x63\\x18\\x04\\x00\\x0a\\x01\\x00\\x0a\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x00\\x01\\x01\\x00\\x87\\x0b\\x6f\\x62\\x6a\\x65\\x63\\x74\\x43\\x6c\\x61\\x73\\x73",
    "read_pattern": "supportedLDAPVersion:\\s*([0-9]+)",
    "service_override": "ldap",
    "version_template": "v{{group_1}}",
    "timeout_ms": 4000
  },
  {
    "name": "LDAPS-Root-DSE",
    "protocol": "TCP",
    "ports": [636],
    "priority": 15,
    "requires_tls": true,
    "send_payload": "\\x30\\x1d\\x02\\x01\\x01\\x63\\x18\\x04\\x00\\x0a\\x01\\x00\\x0a\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x00\\x01\\x01\\x00\\x87\\x0b\\x6f\\x62\\x6a\\x65\\x63\\x74\\x43\\x6c\\x61\\x73\\x73",
    "read_pattern": "supportedLDAPVersion:\\s*([0-9]+)",
    "service_override": "ldaps",
    "version_template": "v{{group_1}}",
    "timeout_ms": 5000
  },
  {
    "name": "SIP-OPTIONS-Probe-TCP",
    "protocol": "TCP",
    "ports": [5060, 5061],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "OPTIONS sip:{{TARGET_HOST}} SIP/2.0\\r\\nVia: SIP/2.0/TCP {{TARGET_HOST}};branch=z9hG4bKReconRaptor\\r\\nFrom: <sip:probe@{{TARGET_HOST}}>;tag=reconraptor\\r\\nTo: <sip:service@{{TARGET_HOST}}>\\r\\nCall-ID: reconraptor@{{TARGET_HOST}}\\r\\nCSeq: 1 OPTIONS\\r\\nMax-Forwards: 70\\r\\nUser-Agent: r3cond0g/0.2.3\\r\\nContent-Length: 0\\r\\n\\r\\n",
    "read_pattern": "(?im)^(?:Server|User-Agent):\\s*([^\\r\\n]+)",
    "service_override": "sip",
    "version_template": "{{group_1}}",
    "timeout_ms": 4000
  },
  {
    "name": "SIPS-OPTIONS-Probe-TCP",
    "protocol": "TCP",
    "ports": [5061],
    "priority": 15,
    "requires_tls": true,
    "send_payload": "OPTIONS sip:{{TARGET_HOST}} SIP/2.0\\r\\nVia: SIP/2.0/TLS {{TARGET_HOST}};branch=z9hG4bKReconRaptor\\r\\nFrom: <sip:probe@{{TARGET_HOST}}>;tag=reconraptor\\r\\nTo: <sip:service@{{TARGET_HOST}}>\\r\\nCall-ID: reconraptor@{{TARGET_HOST}}\\r\\nCSeq: 1 OPTIONS\\r\\nMax-Forwards: 70\\r\\nUser-Agent: r3cond0g/0.2.3\\r\\nContent-Length: 0\\r\\n\\r\\n",
    "read_pattern": "(?im)^(?:Server|User-Agent):\\s*([^\\r\\n]+)",
    "service_override": "sips",
    "version_template": "{{group_1}}",
    "timeout_ms": 5000
  },
  {
    "name": "XMPP-Stream-Probe",
    "protocol": "TCP",
    "ports": [5222, 5269],
    "priority": 15,
    "requires_tls": false,
    "send_payload": "<?xml version='1.0'?><stream:stream to='{{TARGET_HOST}}' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams' version='1.0'>",
    "read_pattern": "from=['\"]([^'\"]+)['\"].*?version=['\"]([^'\"]+)['\"]",
    "service_override": "xmpp",
    "version_template": "Server: {{group_1}}, Protocol v{{group_2}}",
    "timeout_ms": 4000
  },
  {
    "name": "RDP-Initial-Connect",
    "protocol": "TCP",
    "ports": [3389],
    "priority": 10,
    "requires_tls": false,
    "send_payload": "\\x03\\x00\\x00\\x13\\x0e\\xe0\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x08\\x00\\x03\\x00\\x00\\x00",
    "read_pattern": "\\x03\\x00\\x00\\x13\\x0e\\xd0\\x00\\x00",
    "service_override": "ms-wbt-server",
    "version_template": "RDP Connection Confirm",
    "timeout_ms": 3000
  },
  {
    "name": "Generic-TCP-Fallback-Banner",
    "protocol": "TCP",
    "ports": [],
    "priority": 1000,
    "requires_tls": false,
    "send_payload": "",
    "read_pattern": "^([^\\r\\n]{5,100})$",
    "service_override": "",
    "version_template": "banner: {{group_1}}",
    "timeout_ms": 2000
  }
]
